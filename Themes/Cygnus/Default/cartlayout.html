<script type="text/javascript">
// Responsive Content fix for Windows Phone http://trentwalton.com/2013/01/16/windows-phone-8-viewport-fix
if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
    var msViewportStyle = document.createElement("style");
    msViewportStyle.appendChild(
        document.createTextNode(
            "@-ms-viewport{width:auto!important}"
        )
    );
    document.getElementsByTagName("head")[[0]].appendChild(msViewportStyle); // Fixed for the store
    
    }
</script>

<!-- Vector Font Icons http://fontawesome.io - These font-icons are used in the productview.resx resource file -->
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<!-- Cygnus jQuery Theme-->
<link href="/DesktopModules/NBright/NBrightBuy/Themes/Cygnus/css/jquery-ui-1.10.4.custom.min.css" rel="stylesheet">

<!-- Cygnus CSS -->
<link href="/DesktopModules/NBright/NBrightBuy/Themes/Cygnus/css/cygnus.css" rel="stylesheet">



<!-- This loader needs to be made to work here -->
<div id="loader" class="processing" style="display:none;">[<tag type="label" resourcekey="General.ProcessingDiv" />]</div>


<div id="cartdetails" class="NBB dnnform">
<div id="cartlist"></div>
<div id="cartbilladdress"></div>
<div id="cartshippingoptions"></div>
[<tag type="if" function="hasshippingproviders" display="{ON}"/>]
<div id="cartshippingmethods"></div>
[<tag type="endif" />]
<div id="cartextra"></div>
</div>


<script>
    $(document).ready(function () {

        // JQuery used to move cart elements into required area 
        $('#cartbilladdress').append($('.checkoutbillform'));
        $('#cartshippingoptions').append($('#shippingoptions'));
        $('#cartshippingmethods').append($('#shippingmethods'));
        $('#cartshippingoptions').append($('.checkoutshipform'));
        $('#cartshippingoptions').append($('.checkoutship'));
        $('#cartextra').append($('.checkoutextra'));
        $('#cartlist').append($('#checkoutitemlist'));

        $('.checkoutbillform').show();
        $('.checkoutshipform').show();
        $('.checkoutextra').show();
        $('#checkoutitemlist').show();
        $('#shippingoptions').show();
        $("a[[id*='cmdSaveShipAddress']]").hide();
        $("#selectshipaddress").hide();

        //hide/show shipping option
        if ($("input[[id*='rblshippingoptions']]:checked").val() == "2") $('#shippinginput').show();
        if ($("input[[id*='rblshippingoptions']]:checked").val() == "3") {
            $('.checkoutship').show();
            $('#cartshippingmethods').hide();
            $('#providertemplates').hide();
        }

        $("input[[id*='rblshippingoptions']]").change(function () {
            $('.checkoutship').hide();
            $('#shippinginput').hide();
            $("a[[id*='cmdSaveShipAddress']]").hide();
            $("#selectshipaddress").hide();
            $("#shippinginput").find('input').attr('disabled', 'disabled');
            $('#cartshippingmethods').show();
            if ($(this).val() == "2") {
                $('#shippinginput').show();
                $("a[[id*='cmdSaveShipAddress']]").show();
                $("#selectshipaddress").show();
                $("#shippinginput").find('input').removeAttr('disabled');
            }
            if ($(this).val() == "3") {
                $('.checkoutship').show();
                $('#cartshippingmethods').hide();
                $('#providertemplates').hide();
            }
            if ($(this).val() != "3") $("input[[id*='_cmdConfirm_']]").trigger("click");
        });


        $("select[[id*='selectaddress']]").change(function () {
            populateAddressForm($(this).attr('formselector'), $(this).find('option:selected').attr('datavalue'), $(this).find('option:selected').attr('data'));
        });

        function populateAddressForm(selectordiv, datavalue, data) {
            // Take the address dropdown data and popluate the address for with it.
            // selectordiv = the selector for the form section that needs popluating
            // datavalue = the list of field ids that need popluating (in seq order matching the "data" param)
            // data = the list of data values to be populated.
            if (data != null && data != '') {
                var datarray = data.split(',');
                var valuearray = datavalue.split(',');
                var arrayLength = valuearray.length;
                for (var i = 0; i < arrayLength; i++) {
                    $(selectordiv).find("[[id*='" + valuearray[[i]] + "']]").val(datarray[[i]]);
                }
            }
        }

        // auto fire postback when the country dropdown is changed. 
        $("select[[id*='_Country_']]").change(function () {
            $("input[[id*='_cmdConfirm_']]").trigger("click");
    });
        // auto fire postback when the region dropdown is changed. 
        $("select[[id*='_Region_']]").change(function () {
            $("input[[id*='_cmdConfirm_']]").trigger("click");
        });

        // auto fire postback when the shipping providerdropdown is changed. 
        $("input[[id*='_shippingprovider_']]").change(function (e) {
            $("input[[id*='_cmdConfirm_']]").trigger("click");
        });

        // disable validation on hidden controls
        if ($('#shippinginput').is(':visible')) {
            $("#shippinginput").find('input').removeAttr('disabled');
        }
        else {
            $("#shippinginput").find('input').attr('disabled', 'disabled');
        }

        // update the order email with the billing email, if it's not already there
        $('.checkoutbillform input[[id*="_Email_"]]').change(function(e) {
            if ($('input[[id*="_cartemailaddress_"').val() == '') $('input[[id*="_cartemailaddress_"').val($(this).val());
        });

    });
</script>