<!-- jQuery style just for dev, to be removed as needed -->
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">

<!-- In this template we are using a function defined in nbbajax.js and jquery.genxmlajax.js so include the script here -->
<script type="text/javascript" src="/DesktopModules/NBright/NBrightBuy/Themes/config/js/nbbajax.js"></script>
<script src="/DesktopModules/NBright/NBrightBuy/Themes/config/js/jquery.genxmlajax.js" type="text/javascript"></script>
<!-- return field for ajax calls -->
[<tag id="nbxrtn" type="hidden" />]
[<tag id="nbxprocessing" type="hidden" />]
[<tag id="nbxaction" type="hidden" />]

<script>

    $(document).ready(function () {

        // ajax call returned data, so action based on the action being done.
        $('input[[id*=nbxrtn]]').change(function () {
            //we need this event to pick up the data returned and move it into the correct div as html
            if ($('input[[id*="nbxaction"]]').val() == 'getproductlist') {
                $('#productlist').html($(this).val());
                $(this).val('');
            }
        });

        $('input[[id *= "nbxprocessing"]]').change(function () {
            $('#notifymsg').html($('input[[id*=nbxrtn]]').val());
        });

        // save the category data
        $('#categorysave').click(function () {
            CKEditor_TextBoxEncode($('textarea[[id*="message"]]').attr('id'), 0); // need this to get ckeditor text
            nbxget('setcategoryadminform', '#categorydata', 'setcategory'); // stage 1 update
        });

        $("#tabs").tabs();

        nbxget('getproductselectlist', '#categorydata', 'getproductlist'); // stage 1 update


    });

</script>
<div id="notifymsg"></div>

<br />
[<tag id="cmdReturn" type="linkbutton" resourcekey="General.cmdReturn" commandname="return" />] - 
<a href="#" id="categorysave">[<tag type="valueof" resourcekey="General.cmdSave" />]</a>

<br /><br /><br />

<div id="tabs">
  <ul>
    <li><a href="#tabs-1">General</a></li>
    <li><a href="#tabs-2">Description</a></li>
    <li><a href="#tabs-3">Images</a></li>
    <li><a href="#tabs-4">Products</a></li>
  </ul>
<div id="categorydata">
  <div id="tabs-1">
    [<tag id="itemid" type="hidden" databind="ItemId" />]
    [<tag id="lang" type="hidden" databind="Lang" />]
    [<tag id="fields" type="postback" value="genxml/textbox/image,genxml/textbox/txtcategoryref,genxml/dropdownlist/ddlgrouptype,genxml/textbox/producttemplate,genxml/textbox/listitemtemplate,genxml/dropdownlist/ddlparentcatid" />]
    [<tag id="localizedfields" type="postback" value="genxml/textbox/txtcategoryname,genxml/textbox/txtcategorydesc,genxml/textbox/txtseoname,genxml/textbox/txtmetadescription,genxml/textbox/txtmetakeywords,genxml/textbox/txtseopagetitle,genxml/textbox/message" />]

    [<tag id="header" type="hidden" value="categoryproductheader.html"/>]
    [<tag id="body" type="hidden" value="categoryproductbody.html"/>]
    [<tag id="footer" type="hidden" value="categoryproductfooter.html"/>]
    [<tag id="orderby" type="hidden" value="order by NB3.productname"/>]
      

      <h2>CATEGORY DATA</h2>
    <br />
    Ref:   [<tag id="txtcategoryref" type="textbox" width="300" maxlength="250" />]&nbsp;[<tag type="valueof" databind="ItemId" />]<br />
    Group Type:   [<tag id="ddlgrouptype" type="groupdropdown" />]<br />
    Name:   [<tag id="txtcategoryname" type="textbox" width="300" maxlength="250" />]<br />
    Description:   <br />[<tag id="txtcategorydesc" type="textbox" width="300" maxlength="250" height="100" textmode="MultiLine" />]<br />
    Parent:   [<tag id="ddlparentcatid" type="catdropdown" allowblank="true" />] <br />
    Product Display Template:   [<tag id="producttemplate" type="textbox" width="300" maxlength="250" />]<br />
    List Template:   [<tag id="listitemtemplate" type="textbox" width="300" maxlength="250" />]<br />

    SEO Name:   [<tag id="txtseoname" type="textbox" width="300" maxlength="250" />]<br />
    SEO Page Title:   [<tag id="txtseopagetitle" type="textbox" width="300" maxlength="250" />]<br />
    Meta Description:   <br />[<tag id="txtmetadescription" type="textbox" width="300" maxlength="250" height="100" textmode="MultiLine" />]<br />
    Meta Keywords: <br />[<tag id="txtmetakeywords" type="textbox" width="300" maxlength="250" height="100" textmode="MultiLine" />]<br />

  </div>
    <br />
    <br />
  <div id="tabs-2">
    [<tag id="message" type="ckeditor" height="400" width="800"  />]
  </div>
  <div id="tabs-3">
      [<tag id="image" type="fileupload" />]    <br/>
      [<tag id="cmdUpload" type="linkbutton" resourcekey="General.cmdUploadFile" commandname="uploadimage" />]  
      [<tag type='imageof' xpath='genxml/hidden/imageurl' thumb="350" />] 
  </div>
  <div id="tabs-4">
      <div id="productlist">

      </div>
  </div>
</div>
</div>
