<!-- This loader needs to be made to work here -->
<div id="loader" class="processing" style="display:none">[<tag type="htmlof" resourcekey="Cartview.ProcessingDiv" />]</div>

[<tag id="currentcartstage" type="postback" value="" persistance="True"  />]

<!-- Layout template -->
<div id="cartdetails" class="nbs dnnform"  style="display:none;" >
<div id="cartlist" style="display:none;"></div>
    
    <div style="clear:both;">
        [<tag id="cmdUpdate" type="button" cssclass="primarybutton updatecart" resourcekey="CartView.UpdateCart" commandname="updatecart" />]
		[<tag id="cmdDelete" type="button" cssclass="secondarybutton clearcart" resourcekey="CartView.cmdClearCart" commandname="deletecart" />]	
		[<tag id="cmdGotoCart" type="button" cssclass="primarybutton" resourcekey="CartView.Order" commandname="gotocart" />]
    </div>

</div>

<script type="text/javascript">

    $(document).ready(function () {

        // JQuery used to move cart elements into required area 
        $('#cartlist').append($('#checkoutitemlist'));
        $('#checkoutitemlist').show();

        $('#cartlist').show();
        $('#cartdetails').show();
		
        $("#Form").submit(function (e) {
            // switch of stage done here, so validation doesn't stop stage change working correctly.
			$("input[[id*='currentcartstage']]").val('nextcartaddress');
            $(".processing").show();
        });

    });
</script>
